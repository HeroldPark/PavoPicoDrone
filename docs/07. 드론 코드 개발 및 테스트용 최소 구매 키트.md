# 🧪 드론 코드 개발 및 테스트용 최소 구매 키트

## 🎯 목표: 전체 투자 전 펌웨어 개발 및 검증

**총 예상 비용: $50-80** (전체 프로젝트 대비 20% 투자로 80% 리스크 감소)

---

## 📦 1단계: 핵심 개발 키트 ($35-50)

### Arduino Nano ESP32 + 센서
**필수 구매:**
- **Arduino Nano ESP32**: $18-25
  - 메인 컨트롤러
  - Wi-Fi/Bluetooth 테스트 가능
- **MPU9250 또는 ICM-20948**: $8-15
  - 자세 제어 알고리즘 개발
  - 센서 퓨전 테스트

### 브레드보드 및 연결 부품
- **브레드보드**: $3-5
- **점퍼 와이어**: $3-5
- **저항 (풀업용)**: $2

---

## 🔧 2단계: 모터 제어 테스트 ($15-25)

### 단일 모터 테스트 세트
**구매 옵션 A: 실제 드론 모터**
- **1103 8000KV 모터**: $8-12 (1개만)
- **간단한 ESC**: $10-15 (단일채널)

**구매 옵션 B: 서보 모터 (저렴한 대안)**
- **SG90 서보모터**: $3-5 (4개)
- PWM 신호 테스트용

---

## 💻 3단계: 개발 환경 구성 (무료)

### 소프트웨어 도구
- **Arduino IDE 2.0**: 무료
- **ESP32 보드 패키지**: 무료
- **시뮬레이터**: 
  - **Cleanflight Configurator**: 무료
  - **Betaflight Simulator**: 무료 (기본 PID 튜닝 학습)

---

## 🧪 4단계: 테스트 프레임 (DIY)

### 3D 프린팅 테스트 프레임
**파일 다운로드** (무료):
- Thingiverse에서 "Arduino Drone Test Frame" 검색
- 최소 크기: 100mm 휠베이스

**대안 - 골판지 프레임**:
- 재료비: $2-3
- 30분 제작 시간

---

## 📋 단계별 개발 및 테스트 계획

### **Week 1-2: 기본 하드웨어 검증**
```cpp
개발 목표:
✅ Arduino Nano ESP32 보드 테스트
✅ MPU9250 I2C 통신 확인
✅ 센서 데이터 읽기 (가속도, 자이로, 자력계)
✅ Wi-Fi 연결 및 웹서버 구축

테스트 코드:
• 센서 캘리브레이션
• 데이터 시각화 (웹 대시보드)
• 기본 필터링 (저역통과 필터)
```

### **Week 3-4: 자세 추정 알고리즘**
```cpp
개발 목표:
✅ 쿼터니언 기반 자세 계산
✅ 상보 필터 또는 칼만 필터 구현
✅ Roll, Pitch, Yaw 각도 계산
✅ 드리프트 보정 알고리즘

검증 방법:
• 시리얼 모니터로 각도 확인
• 수동으로 보드 회전하며 정확도 측정
```

### **Week 5-6: PID 제어 시스템**
```cpp
개발 목표:
✅ PID 컨트롤러 구현
✅ 각속도 PID (Rate Mode)
✅ 각도 PID (Angle Mode)
✅ PID 파라미터 실시간 튜닝

테스트 방법:
• 서보모터로 PID 응답 확인
• 시뮬레이션으로 안정성 검증
```

### **Week 7-8: 모터 제어 및 믹싱**
```cpp
개발 목표:
✅ DShot 프로토콜 구현
✅ 쿼드콥터 모터 믹싱 알고리즘
✅ 추력 매핑 (스로틀 → PWM)
✅ 모터 아밍/디스아밍 안전 기능

테스트 방법:
• 단일 모터로 DShot 통신 확인
• 오실로스코프로 신호 검증 (옵션)
```

---

## 🔬 핵심 검증 포인트

### **하드웨어 호환성**
- [ ] ESP32 ↔ MPU9250 I2C 통신 안정성
- [ ] 샘플링 레이트 달성 (1kHz 이상)
- [ ] 전력 소비 측정
- [ ] 발열 테스트

### **펌웨어 성능**
- [ ] 루프 타임 측정 (목표: 1ms 이하)
- [ ] 메모리 사용량 확인
- [ ] 실시간 응답성 검증
- [ ] 센서 노이즈 필터링 효과

### **제어 알고리즘**
- [ ] PID 안정성 (시뮬레이션)
- [ ] 자세 추정 정확도 (±2도 이하)
- [ ] 제어 지연 시간 (10ms 이하)

---

## 💡 개발 효율성 팁

### **빠른 프로토타이핑**
```cpp
// 단계별 모듈 개발
1. sensor_manager.cpp     // 센서 데이터 관리
2. attitude_estimator.cpp // 자세 추정
3. pid_controller.cpp     // PID 제어
4. motor_mixer.cpp        // 모터 믹싱
5. safety_manager.cpp     // 안전 기능
```

### **디버깅 도구**
- **웹 기반 모니터링**: 실시간 센서 데이터 확인
- **로그 시스템**: SD카드에 비행 데이터 저장
- **시리얼 플로터**: Arduino IDE 내장 도구 활용

### **시뮬레이션 활용**
- **MATLAB/Simulink**: 정밀한 제어 시스템 설계
- **Python matplotlib**: 빠른 데이터 시각화
- **웹 시뮬레이터**: 3D 자세 확인

---

## ⚠️ 주의사항 및 예상 이슈

### **예상되는 기술적 도전**
1. **센서 노이즈**: 진동에 민감한 MPU9250
2. **타이밍 이슈**: 실시간 제어 루프 구현
3. **메모리 부족**: ESP32 RAM 제한
4. **전력 관리**: 저전력 모드 구현

### **해결 방안**
- **하드웨어 필터**: RC 필터 추가
- **소프트웨어 최적화**: 인터럽트 기반 처리
- **메모리 최적화**: 동적 할당 최소화
- **배터리 모니터링**: 전압 체크 알고리즘

---

## 🎯 성공 기준

### **최소 성공 기준**
- [ ] 안정적인 센서 데이터 획득
- [ ] 정확한 자세 추정 (±5도)
- [ ] 기본 PID 제어 동작

### **우수 성공 기준**
- [ ] 1kHz 제어 루프 달성
- [ ] 실시간 파라미터 튜닝 가능
- [ ] 웹 기반 모니터링 시스템 완성

**이 단계를 성공적으로 완료하면 실제 드론 제작에 90% 이상 성공 확률을 보장할 수 있습니다!**